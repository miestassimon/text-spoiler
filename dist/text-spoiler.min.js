"use strict";function _classCallCheck(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}function _createClass(e,t,i){if(t)_defineProperties(e.prototype,t);if(i)_defineProperties(e,i);return e}(function(){var n=function(){function s(e,t){_classCallCheck(this,s);this.options={isCollapsed:false,lines:t,expandedHeight:0,collapsedHeight:0,lineHeight:0,buttonTextExpanded:"Читать дальше",buttonTextCollapsed:"Скрыть"};this.node=e;this.initDefaultValues()}_createClass(s,[{key:"createButton",value:function e(){this.button=document.createElement("button");this.button.className="spoiler";this.button.addEventListener("click",this.buttonClickHandler.bind(this));this.node.parentElement.appendChild(this.button)}},{key:"buttonClickHandler",value:function e(t){this.toggleState();this.updateView()}},{key:"toggleState",value:function e(){this.options.isCollapsed=!this.options.isCollapsed}},{key:"initDefaultValues",value:function e(){var t=this;var i,n,o;window.addEventListener("load",function(){i=t.node.offsetHeight;o=s.getLineHeight(t.node);n=t.options.lines*o;if(n>=i)return;t.options.expandedHeight=i;t.options.collapsedHeight=n;t.options.lineHeight=o;t.createButton();t.setNodeBaseStyle();t.updateView()})}},{key:"updateView",value:function e(){this.node.style.height=this.options.isCollapsed?this.options.collapsedHeight+"px":this.options.expandedHeight+"px";this.button.innerHTML=this.options.isCollapsed?this.options.buttonTextCollapsed:this.options.buttonTextExpanded}},{key:"setNodeBaseStyle",value:function e(){this.node.style.overflow="hidden"}}],[{key:"getLineHeight",value:function e(t){var i;var n=window.getComputedStyle(t).lineHeight;if(n!=="normal"){i=n}else{var o=t.cloneNode();o.innerHTML="&nbsp;";o.style.position="absolute";t.appendChild(o);i=o.offsetHeight;t.removeChild(o)}return i}}]);return s}();var e=function e(t){var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:6;_classCallCheck(this,e);t=t||"[data-text-spoiler]";document.querySelectorAll(t).forEach(function(e){i=+e.getAttribute("data-text-spoiler")||+i;new n(e,i)})};return window.TextSpoiler=e})();